webpackJsonp([7,11],{30:function(e,t,o){t=e.exports=o(2)(),t.push([e.id,".input-mini{width:120px}",""])},35:function(e,t,o){var r=o(30);"string"==typeof r&&(r=[[e.id,r,""]]);o(3)(r,{});r.locals&&(e.exports=r.locals)},55:function(e,t,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=o(5),a=r(s);t.default={props:["data"],data:function(){return{form:(0,a.default)({smtpHost:"",smtpPort:465,sslEnable:!0,emailAccount:"",emailPassword:""},this.data),rules:{smtpHost:{required:!0},smtpPort:{required:!0},emailAccount:{required:!0},emailPassword:{required:!0}}}},methods:{emailChange:function(){var e=this.form.emailAccount;if(e.lastIndexOf("@")>-1){var t=e.substr(e.lastIndexOf("@")+1);this.form.smtpHost="smtp."+t}},saveAction:function(){var e=this;this.$refs.form.validate(function(t){t?(delete e.form.createTime,e.$emit("save",e.form)):e.$message.error("表单校验失败")})}}}},56:function(e,t,o){var r,s;o(35),r=o(55);var a=o(57);s=r=r||{},"object"!=typeof r.default&&"function"!=typeof r.default||(s=r=r.default),"function"==typeof s&&(s=s.options),s.render=a.render,s.staticRenderFns=a.staticRenderFns,e.exports=r},57:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-form",{ref:"form",attrs:{"label-position":"top",rules:e.rules,model:e.form}},[o("el-form-item",{attrs:{label:"Email",prop:"emailAccount"}},[o("el-input",{directives:[{name:"model",rawName:"v-model",value:e.form.emailAccount,expression:"form.emailAccount"}],attrs:{placeholder:"Email"},domProps:{value:e.form.emailAccount},on:{change:e.emailChange,input:function(t){e.form.emailAccount=t}}})],1),o("el-form-item",{attrs:{label:"Password",prop:"emailPassword"}},[o("el-input",{directives:[{name:"model",rawName:"v-model",value:e.form.emailPassword,expression:"form.emailPassword"}],attrs:{type:"password",placeholder:"Password"},domProps:{value:e.form.emailPassword},on:{input:function(t){e.form.emailPassword=t}}})],1),o("el-form-item",{attrs:{label:"SMTP",prop:"smtpHost"}},[o("div",{staticClass:"flex"},[o("el-input",{directives:[{name:"model",rawName:"v-model",value:e.form.smtpHost,expression:"form.smtpHost"}],staticClass:"flex1",attrs:{placeholder:"SMTP服务地址"},domProps:{value:e.form.smtpHost},on:{input:function(t){e.form.smtpHost=t}}}),o("span",[e._v(" : ")]),o("el-input",{directives:[{name:"model",rawName:"v-model",value:e.form.smtpPort,expression:"form.smtpPort"}],staticClass:"input-mini",attrs:{placeholder:"端口"},domProps:{value:e.form.smtpPort},on:{input:function(t){e.form.smtpPort=t}}}),o("el-checkbox",{directives:[{name:"model",rawName:"v-model",value:e.form.sslEnable,expression:"form.sslEnable"}],attrs:{number:"number"},domProps:{value:e.form.sslEnable},on:{input:function(t){e.form.sslEnable=t}}},[e._v("启用SSL")])],1)]),o("el-form-item",[o("el-button",{attrs:{"native-type":"submit",type:"primary"},on:{click:function(t){t.preventDefault(),e.saveAction(t)}}},[e._v("保存")])],1)],1)},staticRenderFns:[]}},211:function(e,t,o){t=e.exports=o(2)(),t.push([e.id,".user-init{width:600px;margin:auto;padding-top:120px}.init-wrapper{margin-top:2em}",""])},238:function(e,t,o){var r=o(211);"string"==typeof r&&(r=[[e.id,r,""]]);o(3)(r,{});r.locals&&(e.exports=r.locals)},418:function(e,t,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=o(56),a=r(s);t.default={components:{EmailConfigEdit:a.default},data:function(){return{loading:!1,step:2,emailConfig:{},userForm:{username:"",password:"",code:""},rules:{username:{required:!0,type:"email"},password:{required:!0},code:{required:!0}}}},created:function(){var e=this;this.$get("user/init-email-config").then(function(t){var o=t.data;o&&(e.emailConfig=o,e.step=2)})},methods:{load:function(){this.loading=!0},loaded:function(){this.loading=!1},sendCode:function(){var e=this;this.$refs.form.validateField("username",function(t){t||(e.load(),e.$post("user/init-send-email",{email:e.userForm.username}).then(function(){e.$message.success("发送验证码成功")}).finally(e.loaded))})},saveUser:function(){var e=this;this.$refs.form.validate(function(t){t&&(e.load(),e.$post("user/init-register",e.userForm).then(function(){e.$message.success("注册成功"),e.$router.replace({name:"login"})}).finally(e.loaded))})},saveConfig:function(e){var t=this;this.load(),this.emailConfig=e,this.$post("user/init-step-email-config",e).then(function(e){var o=e.data;t.emailConfig=o,t.step=2}).finally(function(){return t.loaded()})},pre:function(){this.step--},next:function(){this.step++}}}},443:function(e,t,o){var r,s;o(238),r=o(418);var a=o(458);s=r=r||{},"object"!=typeof r.default&&"function"!=typeof r.default||(s=r=r.default),"function"==typeof s&&(s=s.options),s.render=a.render,s.staticRenderFns=a.staticRenderFns,e.exports=r},458:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"user-init"},[o("el-steps",{attrs:{space:200,active:e.step}},[o("el-step",{attrs:{title:"邮箱配置",description:"输入邮箱配置，作为服务器发件方的配置"}}),o("el-step",{attrs:{title:"账号配置",description:"后台的管理员端账号配置"}})],1),o("div",{staticClass:"init-wrapper"},[1===e.step?o("email-config-edit",{attrs:{data:e.emailConfig},on:{save:e.saveConfig}}):e._e(),2===e.step?[o("el-form",{ref:"form",attrs:{"label-position":"top",rules:e.rules,model:e.userForm}},[o("el-form-item",{attrs:{label:"用户名",prop:"username"}},[o("el-input",{directives:[{name:"model",rawName:"v-model",value:e.userForm.username,expression:"userForm.username"}],attrs:{type:"email",placeholder:"Email"},domProps:{value:e.userForm.username},on:{input:function(t){e.userForm.username=t}}})],1),o("el-form-item",{attrs:{label:"密码",prop:"password"}},[o("el-input",{directives:[{name:"model",rawName:"v-model",value:e.userForm.password,expression:"userForm.password"}],attrs:{type:"password",placeholder:"Password"},domProps:{value:e.userForm.password},on:{input:function(t){e.userForm.password=t}}})],1),o("el-form-item",{attrs:{label:"邮箱验证码",prop:"code"}},[o("div",{staticClass:"flex"},[o("el-input",{directives:[{name:"model",rawName:"v-model",value:e.userForm.code,expression:"userForm.code"}],staticClass:"flex-1",domProps:{value:e.userForm.code},on:{input:function(t){e.userForm.code=t}}}),o("el-button",{on:{click:e.sendCode}},[e._v("发送邮箱验证码")])],1)]),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:e.pre}},[e._v("上一步")]),o("el-button",{attrs:{"native-type":"submit",type:"primary"},on:{click:function(t){t.preventDefault(),e.saveUser(t)}}},[e._v("保存")])],1)],1)]:e._e()],2)],1)},staticRenderFns:[]}}});