webpackJsonp([15,11],{209:function(t,e,a){e=t.exports=a(2)(),e.push([t.id,"",""])},235:function(t,e,a){var r=a(209);"string"==typeof r&&(r=[[t.id,r,""]]);a(3)(r,{});r.locals&&(t.exports=r.locals)},400:function(t,e,a){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=a(5),i=r(o),n=a(19),s=a(191),l=r(s),u=a(8),m=r(u);e.default={props:["data","value"],mixins:[l.default],components:{MarkdownEditor:n.MarkdownEditor},watch:{"form.content":function(){var t=this;this.$nextTick(function(){t.generatorSummary()})}},created:function(){var t=this;this.$get("catalog/list").then(function(e){var a=e.data;t.catalogs=a}),this.$get("tag/list").then(function(e){var a=e.data;t.tags=a})},computed:{banner:function(){var t=[];return this.form.banner&&(t=[{name:"banner",url:this.form.banner}]),t},isDraft:function(){return 1===this.form.status}},data:function(){return{catalogs:[],tags:[],uploadUrl:m.default.globalOptions.uploadUrl,form:(0,i.default)({content:"",title:"",summary:"",banner:"",catalogId:null,status:1,tagIds:[]},this.data),rules:{title:{required:!0}}}},methods:{uploadSuccess:function(t){this.form.banner=t},generatorSummary:function(){this.form.summary=this.$refs.editor.getText().replace(/\n/g," ").substr(0,300)},saveDraft:function(){this.saveHistory(),this.$emit("close")},saveHistory:function(){var t=this;if(this.isDraft)return this.$post("article/save/draft",this.form,{emulateJSON:!1}).then(function(e){var a=e.data;t.form.id!==a.id&&(t.form=(0,i.default)({},t.form,{id:a.id}))})},saveAction:function(){this.generatorSummary(),this.$emit("save",this.form)}}}},425:function(t,e,a){var r,o;a(235),r=a(400);var i=a(455);o=r=r||{},"object"!=typeof r.default&&"function"!=typeof r.default||(o=r=r.default),"function"==typeof o&&(o=o.options),o.render=i.render,o.staticRenderFns=i.staticRenderFns,t.exports=r},455:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"article-editor"},[a("el-form",{ref:"form",attrs:{"label-position":"left","label-width":"100px",rules:t.rules,model:t.form}},[a("div",{staticClass:"flexrow"},[a("el-upload",{staticClass:"flex-1 full-upload",attrs:{action:t.uploadUrl,name:"file","thumbnail-mode":!0,type:"drag","on-success":t.uploadSuccess,"default-file-list":t.banner,multiple:!1}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-dragger__text"},[t._v("上传文章的banner图")])]),a("div",{staticClass:"flex-1"},[a("el-form-item",{attrs:{label:"文章标题",prop:"title"}},[a("el-input",{directives:[{name:"model",rawName:"v-model",value:t.form.title,expression:"form.title"}],domProps:{value:t.form.title},on:{input:function(e){t.form.title=e}}})],1),a("el-form-item",{attrs:{label:"所属栏目"}},[a("el-select",{directives:[{name:"model",rawName:"v-model",value:t.form.catalogId,expression:"form.catalogId"}],attrs:{placeholder:"请选择"},domProps:{value:t.form.catalogId},on:{input:function(e){t.form.catalogId=e}}},t._l(t.catalogs,function(t){return a("el-option",{attrs:{label:t.name,value:t.id}})}))],1),a("el-form-item",{attrs:{label:"文章标签"}},[a("el-select",{directives:[{name:"model",rawName:"v-model",value:t.form.tagIds,expression:"form.tagIds"}],attrs:{placeholder:"请选择",multiple:"multiple",filterable:"filterable","allow-create":"allow-create"},domProps:{value:t.form.tagIds},on:{input:function(e){t.form.tagIds=e}}},t._l(t.tags,function(t){return a("el-option",{attrs:{label:t.name,value:t.id}})}))],1)],1)],1),a("div",{staticClass:"markdown-editor"},[a("markdown-editor",{directives:[{name:"model",rawName:"v-model",value:t.form.content,expression:"form.content"}],ref:"editor",attrs:{upload:{url:t.uploadUrl,name:"file",accept:"image/jpg,image/jpeg,image/png,image/gif"},options:t.MarkdownOptions,height:"100%","z-index":"2017"},domProps:{value:t.form.content},on:{"save-history":t.saveHistory,input:function(e){t.form.content=e}}})],1),a("el-form-item",{attrs:{label:"摘要",prop:"summary",hidden:"hidden"}},[a("el-input",{directives:[{name:"model",rawName:"v-model",value:t.form.summary,expression:"form.summary"}],attrs:{type:"textarea",autosize:{minRows:4,maxRows:8}},domProps:{value:t.form.summary},on:{input:function(e){t.form.summary=e}}})],1),a("el-form-item",{staticClass:"el-dialog__footer"},[t.isDraft?a("el-button",{attrs:{type:"primary"},on:{click:function(e){e.preventDefault(),t.saveDraft(e)}}},[t._v("保存")]):t._e(),a("el-button",{attrs:{"native-type":"submit",type:"primary"},on:{click:function(e){e.preventDefault(),t.saveAction(e)}}},[t._v("保存并发布")])],1)],1)],1)},staticRenderFns:[]}}});