webpackJsonp([7,11],{37:function(e,t,s){t=e.exports=s(2)(),t.push([e.id,".input-mini{width:120px}",""])},42:function(e,t,s){var r=s(37);"string"==typeof r&&(r=[[e.id,r,""]]);s(3)(r,{});r.locals&&(e.exports=r.locals)},68:function(e,t,s){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=s(4),a=r(o);t.default={props:["data"],data:function(){return{form:(0,a.default)({smtpHost:"",smtpPort:465,sslEnable:!0,emailAccount:"",emailPassword:""},this.data),rules:{smtpHost:{required:!0},smtpPort:{required:!0},emailAccount:{required:!0},emailPassword:{required:!0}}}},methods:{emailChange:function(){var e=this.form.emailAccount;if(e.lastIndexOf("@")>-1){var t=e.substr(e.lastIndexOf("@")+1);this.form.smtpHost="smtp."+t}},saveAction:function(){var e=this;this.$refs.form.validate(function(t){t?(delete e.form.createTime,e.$emit("save",e.form)):e.$message.error("表单校验失败")})}}}},69:function(e,t,s){var r,o;s(42),r=s(68);var a=s(70);o=r=r||{},"object"!=typeof r.default&&"function"!=typeof r.default||(o=r=r.default),"function"==typeof o&&(o=o.options),o.render=a.render,o.staticRenderFns=a.staticRenderFns,e.exports=r},70:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-form",{ref:"form",attrs:{"label-position":"top",rules:e.rules,model:e.form}},[s("el-form-item",{attrs:{label:"Email",prop:"emailAccount"}},[s("el-input",{attrs:{placeholder:"Email"},on:{change:e.emailChange},model:{value:e.form.emailAccount,callback:function(t){e.form.emailAccount=t},expression:"form.emailAccount"}})],1),s("el-form-item",{attrs:{label:"Password",prop:"emailPassword"}},[s("el-input",{attrs:{type:"password",placeholder:"Password"},model:{value:e.form.emailPassword,callback:function(t){e.form.emailPassword=t},expression:"form.emailPassword"}})],1),s("el-form-item",{attrs:{label:"SMTP",prop:"smtpHost"}},[s("div",{staticClass:"flex"},[s("el-input",{staticClass:"flex1",attrs:{placeholder:"SMTP服务地址"},model:{value:e.form.smtpHost,callback:function(t){e.form.smtpHost=t},expression:"form.smtpHost"}}),s("span",[e._v(" : ")]),s("el-input",{staticClass:"input-mini",attrs:{placeholder:"端口"},model:{value:e.form.smtpPort,callback:function(t){e.form.smtpPort=t},expression:"form.smtpPort"}}),s("el-checkbox",{attrs:{number:"number"},model:{value:e.form.sslEnable,callback:function(t){e.form.sslEnable=t},expression:"form.sslEnable"}},[e._v("启用SSL")])],1)]),s("el-form-item",[s("el-button",{attrs:{"native-type":"submit",type:"primary"},on:{click:function(t){t.preventDefault(),e.saveAction(t)}}},[e._v("保存")])],1)],1)},staticRenderFns:[]}},236:function(e,t,s){t=e.exports=s(2)(),t.push([e.id,".user-init{width:600px;margin:auto;padding-top:120px}.init-wrapper{margin-top:2em}",""])},264:function(e,t,s){var r=s(236);"string"==typeof r&&(r=[[e.id,r,""]]);s(3)(r,{});r.locals&&(e.exports=r.locals)},462:function(e,t,s){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=s(69),a=r(o);t.default={components:{EmailConfigEdit:a.default},data:function(){return{loading:!1,step:2,emailConfig:{},userForm:{username:"",password:"",code:""},rules:{username:{required:!0,type:"email"},password:{required:!0},code:{required:!0}}}},created:function(){var e=this;this.$get("user/init-email-config").then(function(t){var s=t.data;s&&(e.emailConfig=s,e.step=2)})},methods:{load:function(){this.loading=!0},loaded:function(){this.loading=!1},sendCode:function(){var e=this;this.$refs.form.validateField("username",function(t){t||(e.load(),e.$post("user/init-send-email",{email:e.userForm.username}).then(function(){e.$message.success("发送验证码成功")}).finally(e.loaded))})},saveUser:function(){var e=this;this.$refs.form.validate(function(t){t&&(e.load(),e.$post("user/init-register",e.userForm).then(function(){e.$message.success("注册成功"),e.$router.replace({name:"login"})}).finally(e.loaded))})},saveConfig:function(e){var t=this;this.load(),this.emailConfig=e,this.$post("user/init-step-email-config",e).then(function(e){var s=e.data;t.emailConfig=s,t.step=2}).finally(function(){return t.loaded()})},pre:function(){this.step--},next:function(){this.step++}}}},485:function(e,t,s){var r,o;s(264),r=s(462);var a=s(499);o=r=r||{},"object"!=typeof r.default&&"function"!=typeof r.default||(o=r=r.default),"function"==typeof o&&(o=o.options),o.render=a.render,o.staticRenderFns=a.staticRenderFns,e.exports=r},499:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"user-init"},[s("el-steps",{attrs:{space:200,active:e.step}},[s("el-step",{attrs:{title:"邮箱配置",description:"输入邮箱配置，作为服务器发件方的配置"}}),s("el-step",{attrs:{title:"账号配置",description:"后台的管理员端账号配置"}})],1),s("div",{staticClass:"init-wrapper"},[1===e.step?s("email-config-edit",{attrs:{data:e.emailConfig},on:{save:e.saveConfig}}):e._e(),2===e.step?[s("el-form",{ref:"form",attrs:{"label-position":"top",rules:e.rules,model:e.userForm}},[s("el-form-item",{attrs:{label:"用户名",prop:"username"}},[s("el-input",{attrs:{type:"email",placeholder:"Email"},model:{value:e.userForm.username,callback:function(t){e.userForm.username=t},expression:"userForm.username"}})],1),s("el-form-item",{attrs:{label:"密码",prop:"password"}},[s("el-input",{attrs:{type:"password",placeholder:"Password"},model:{value:e.userForm.password,callback:function(t){e.userForm.password=t},expression:"userForm.password"}})],1),s("el-form-item",{attrs:{label:"邮箱验证码",prop:"code"}},[s("div",{staticClass:"flex"},[s("el-input",{staticClass:"flex-1",model:{value:e.userForm.code,callback:function(t){e.userForm.code=t},expression:"userForm.code"}}),s("el-button",{on:{click:e.sendCode}},[e._v("发送邮箱验证码")])],1)]),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.pre}},[e._v("上一步")]),s("el-button",{attrs:{"native-type":"submit",type:"primary"},on:{click:function(t){t.preventDefault(),e.saveUser(t)}}},[e._v("保存")])],1)],1)]:e._e()],2)],1)},staticRenderFns:[]}}});